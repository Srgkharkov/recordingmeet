// package main

// var mediarecorderjs string = `
// // Объект для хранения активных треков и их записей
// const activeMediaRecorders = {};

// // Функция для записи нового потока
// function startRecordingTrack(track, index) {
// 	const stream = new MediaStream([track]);
// 	const mediaRecorder = new MediaRecorder(stream);
// 	const chunks = [];

// 	mediaRecorder.ondataavailable = event => {
// 		if (event.data.size > 0) {
// 			chunks.push(event.data);
// 		}
// 	};

// 	mediaRecorder.onstop = () => {
// 		const blob = new Blob(chunks, { type: 'video/webm' });
// 		const url = URL.createObjectURL(blob);
// 		const a = document.createElement('a');
// 		a.href = url;
// 		a.download = 'stream-' + (index + 1) + '.webm';
// 		a.click();
// 		console.log('Recording stopped for track', track.id);
// 		delete activeMediaRecorders[track.id];
// 	};

// 	mediaRecorder.start();
// 	activeMediaRecorders[track.id] = mediaRecorder;
// 	console.log('Recording started for track', track.id);
// }

// // Функция для обработки медиа-элементов
// function handleMediaElements(mediaElements) {
// 	mediaElements.forEach((element, index) => {
// 		if (element.srcObject) {
// 			const tracks = element.srcObject.getTracks();
// 			tracks.forEach(track => {
// 				if (!activeMediaRecorders[track.id]) {
// 					startRecordingTrack(track, index);
// 				}
// 			});

// 			// Остановка записи, если поток прерывается
// 			element.srcObject.onremovetrack = (event) => {
// 				const track = event.track;
// 				if (activeMediaRecorders[track.id]) {
// 					activeMediaRecorders[track.id].stop();
// 					console.log('Track', track.id, 'removed and recording stopped');
// 				}
// 			};
// 		}
// 	});
// }

// // Функция для наблюдения за изменениями DOM
// function observeMediaChanges() {
// 	const observer = new MutationObserver(mutations => {
// 		mutations.forEach(mutation => {
// 			const addedNodes = Array.from(mutation.addedNodes).filter(node => node.tagName === 'VIDEO' || node.tagName === 'AUDIO');
// 			if (addedNodes.length > 0) {
// 				handleMediaElements(addedNodes);
// 			}
// 		});
// 	});

// 	observer.observe(document.body, {
// 		childList: true,
// 		subtree: true
// 	});
// }

// // Начальная инициализация для уже существующих медиа-элементов
// const initialMediaElements = Array.from(document.querySelectorAll('video, audio'));
// handleMediaElements(initialMediaElements);

// // Запускаем наблюдателя за изменениями DOM
// observeMediaChanges();
// `
